FROM continuumio/anaconda3

# Install backend
RUN apt-get update\
&& apt-get install -y dh-autoreconf build-essential libarchive-dev

# Install singularity
RUN wget https://github.com/sylabs/singularity/releases/download/2.5.2/singularity-2.5.2.tar.gz\
&& tar xvf singularity-2.5.2.tar.gz\
&& cd singularity-2.5.2\
&& ./configure --prefix=/usr/local\
&& make\
&& make install

# Fix mismatch bug between pip and matplotlib
RUN pip uninstall matplotlib\
&& pip install --upgrade pip\
&& pip install matplotlib

# Install requirements
RUN pip install --upgrade pip && pip install future pycondor>=0.5 configargparse spython jinja2 flake8 urllib3 deepdish coverage pytest-cov