Bootstrap: docker
From: bilbydev/bilby_pipe-test-suite-python37

%post
export PATH=/opt/conda/bin:${PATH}
pip install dynesty nestle
git clone https://github.com/lscsoft/bilby.git
(cd bilby && python setup.py install)
git clone https://github.com/lscsoft/bilby_pipe.git
(cd bilby_pipe && python setup.py install)

%runscript
    bilby_pipe "$@" --singularity-image "$SINGULARITY_CONTAINER"

%apprun generation
    bilby_pipe_generation "$@"

%apprun analysis
    bilby_pipe_analysis "$@"

%apprun create_injection_file
    bilby_pipe_create_injection_file "$@"
